{"ast":null,"code":"import _regeneratorRuntime from\"D:/KavtechHRM/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/KavtechHRM/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/KavtechHRM/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useContext}from\"react\";import{Field,useFormik}from\"formik\";// import UseNavigate from 'react-router-dom'\nimport{BoldLink,BoxContainer,FieldContainer,FieldError,FormContainer,FormError,Input,MutedLink,SubmitButton}from\"./common\";import{Marginer}from\"../marginer\";import*as yup from\"yup\";import axios from\"axios\";import{AccountContext}from\"./accountContext\";import{useHistory}from\"react-router-dom\";// const validationSchema = yup.object({\n//   email: yup.string().required(),\n//   password: yup.string().required(),\n// });\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export function LoginForm(props){var _useContext=useContext(AccountContext),switchToSignup=_useContext.switchToSignup;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),error=_useState2[0],setError=_useState2[1];//Authentication\nvar _useState3=useState(localStorage.getItem('authTokens')?JSON.parse(localStorage.getItem('authTokens')):null),_useState4=_slicedToArray(_useState3,2),authTokens=_useState4[0],setAuthTokens=_useState4[1];var _useState5=useState(localStorage.getItem('authTokens')?JSON.parse(localStorage.getItem('authTokens')):null),_useState6=_slicedToArray(_useState5,2),user=_useState6[0],setUser=_useState6[1];var history=useHistory();var _useContext2=useContext(AccountContext),loginUser=_useContext2.loginUser;var contextData={user:user,loginUser:loginUser};// localStorage.getItem('authTokens') ? JSON.parse(localStorage.getItem('authTokens')) :  null)\n//Authentication\nvar onSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(values){var response,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setError(null);_context.next=3;return axios.post(\"http://127.0.0.1:8000/Kavtech/login/\",values).catch(function(err){if(err&&err.response)setError(err.response.data.message);});case 3:response=_context.sent;_context.next=6;return response.json();case 6:data=_context.sent;if(response.status===200){setAuthTokens(data);setUser(data.access);// localStorage.setItem('authTokens', JSON.stringify(data))\nhistory.push('/');alert(\"Login Success !!!\");}else{alert(\"Something Went Wrong!!!\");}case 8:case\"end\":return _context.stop();}}},_callee);}));return function onSubmit(_x){return _ref.apply(this,arguments);};}();var formik=useFormik({initialValues:{email:\"\",password:\"\"},validateOnBlur:true,onSubmit:onSubmit// validationSchema: validationSchema,\n});return/*#__PURE__*/_jsx(BoxContainer,{children:user?/*#__PURE__*/_jsx(BoldLink,{children:\"Logout\"}):/*#__PURE__*/_jsxs(BoxContainer,{children:[/*#__PURE__*/_jsx(FormError,{children:error?error:\"\"}),/*#__PURE__*/_jsxs(FormContainer,{onSubmit:formik.handleSubmit,children:[/*#__PURE__*/_jsxs(FieldContainer,{children:[/*#__PURE__*/_jsx(Input,{name:\"email\",placeholder:\"Email\",value:formik.values.email,onChange:formik.handleChange,onBlur:formik.handleBlur}),/*#__PURE__*/_jsx(FieldError,{children:formik.touched.email&&formik.errors.email?formik.errors.email:\"\"})]}),/*#__PURE__*/_jsxs(FieldContainer,{children:[/*#__PURE__*/_jsx(Input,{name:\"password\",type:\"password\",placeholder:\"Password\",value:formik.values.password,onChange:formik.handleChange,onBlur:formik.handleBlur}),/*#__PURE__*/_jsx(FieldError,{children:formik.touched.password&&formik.errors.password?formik.errors.password:\"\"})]}),/*#__PURE__*/_jsx(MutedLink,{href:\"#\",children:\"Forgot Password?\"}),/*#__PURE__*/_jsx(Marginer,{direction:\"vertical\",margin:\"1em\"}),/*#__PURE__*/_jsx(SubmitButton,{type:\"submit\",disabled:!formik.isValid,children:\"Login\"})]}),/*#__PURE__*/_jsx(Marginer,{direction:\"vertical\",margin:5}),/*#__PURE__*/_jsxs(MutedLink,{href:\"#\",children:[\"Dont have an Account?\",/*#__PURE__*/_jsx(BoldLink,{href:\"#\",onClick:switchToSignup,children:\"sign up\"})]})]})});}","map":{"version":3,"sources":["D:/KavtechHRM/frontend/src/Components/accountBox/loginForm.jsx"],"names":["React","useState","useContext","Field","useFormik","BoldLink","BoxContainer","FieldContainer","FieldError","FormContainer","FormError","Input","MutedLink","SubmitButton","Marginer","yup","axios","AccountContext","useHistory","LoginForm","props","switchToSignup","error","setError","localStorage","getItem","JSON","parse","authTokens","setAuthTokens","user","setUser","history","loginUser","contextData","onSubmit","values","post","catch","err","response","data","message","json","status","access","push","alert","formik","initialValues","email","password","validateOnBlur","handleSubmit","handleChange","handleBlur","touched","errors","isValid"],"mappings":"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","sourcesContent":["import React, { useState ,useContext } from \"react\";\r\nimport { Field, useFormik } from \"formik\";\r\n\r\n// import UseNavigate from 'react-router-dom'\r\nimport {\r\n  BoldLink,\r\n  BoxContainer,\r\n  FieldContainer,\r\n  FieldError,\r\n  FormContainer,\r\n  FormError,\r\n  Input,\r\n  MutedLink,\r\n  SubmitButton,\r\n} from \"./common\";\r\nimport { Marginer } from \"../marginer\";\r\nimport * as yup from \"yup\";\r\nimport axios from \"axios\";\r\nimport { AccountContext } from \"./accountContext\";\r\nimport PropTypes from 'prop-types';\r\nimport { useHistory } from \"react-router-dom\";\r\n// const validationSchema = yup.object({\r\n//   email: yup.string().required(),\r\n//   password: yup.string().required(),\r\n// });\r\n\r\nexport function LoginForm(props) {\r\n\r\n  const { switchToSignup } = useContext(AccountContext);\r\n  const [error, setError] = useState(null);\r\n  //Authentication\r\n  let [ authTokens, setAuthTokens] = useState(localStorage.getItem('authTokens') ? JSON.parse(localStorage.getItem('authTokens')) :  null)\r\n  let [user, setUser] = useState(localStorage.getItem('authTokens') ? JSON.parse(localStorage.getItem('authTokens')) :  null)\r\n  const history = useHistory();\r\n  let {loginUser} = useContext(AccountContext)\r\n  let contextData = {\r\n    user:user,\r\n    loginUser:loginUser\r\n}\r\n// localStorage.getItem('authTokens') ? JSON.parse(localStorage.getItem('authTokens')) :  null)\r\n\r\n  //Authentication\r\n  const onSubmit = async (values) => {\r\n    setError(null);\r\n    const response = await axios\r\n      .post(\"http://127.0.0.1:8000/Kavtech/login/\", values)\r\n      .catch((err) => {\r\n        if (err && err.response) setError(err.response.data.message);\r\n      });\r\n      let data = await response.json()\r\n\r\n      if (response.status === 200){\r\n        setAuthTokens(data)\r\n        setUser(data.access)\r\n        // localStorage.setItem('authTokens', JSON.stringify(data))\r\n        history.push('/')\r\n        alert(\"Login Success !!!\")\r\n\r\n      }else{\r\n        alert(\"Something Went Wrong!!!\")\r\n\r\n      }\r\n  };\r\n\r\n  const formik = useFormik({\r\n    initialValues: { email: \"\", password: \"\" },\r\n    validateOnBlur: true,\r\n    onSubmit,\r\n    // validationSchema: validationSchema,\r\n  });\r\n\r\n  return (\r\n    <BoxContainer>\r\n    {user ? (<BoldLink>Logout</BoldLink> )\r\n    : \r\n    (  \r\n     <BoxContainer>\r\n  \r\n      <FormError>{error ? error : \"\"}</FormError>\r\n      <FormContainer onSubmit={formik.handleSubmit}>\r\n        <FieldContainer>\r\n          <Input\r\n            name=\"email\"\r\n            placeholder=\"Email\"\r\n            value={formik.values.email}\r\n            onChange={formik.handleChange}\r\n            onBlur={formik.handleBlur}\r\n          />\r\n          {\r\n            <FieldError>\r\n              {formik.touched.email && formik.errors.email\r\n                ? formik.errors.email\r\n                : \"\"}\r\n            </FieldError>\r\n          }\r\n        </FieldContainer>\r\n        <FieldContainer>\r\n          <Input\r\n            name=\"password\"\r\n            type=\"password\"\r\n            placeholder=\"Password\"\r\n            value={formik.values.password}\r\n            onChange={formik.handleChange}\r\n            onBlur={formik.handleBlur}\r\n          />\r\n          {\r\n            <FieldError>\r\n              {formik.touched.password && formik.errors.password\r\n                ? formik.errors.password\r\n                : \"\"}\r\n            </FieldError>\r\n          }\r\n        </FieldContainer>\r\n        <MutedLink href=\"#\">Forgot Password?</MutedLink>\r\n        <Marginer direction=\"vertical\" margin=\"1em\" />\r\n        <SubmitButton type=\"submit\" disabled={!formik.isValid}>\r\n          Login\r\n        </SubmitButton>\r\n      </FormContainer>\r\n      <Marginer direction=\"vertical\" margin={5} />\r\n      <MutedLink href=\"#\">\r\n        Dont have an Account?\r\n        <BoldLink href=\"#\" onClick={switchToSignup}>\r\n          sign up\r\n        </BoldLink>\r\n      </MutedLink>\r\n    </BoxContainer> )}\r\n    </BoxContainer>\r\n    \r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}